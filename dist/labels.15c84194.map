{"version":3,"sources":["js/labels.js"],"names":["hideLabel","label","labelObject","style","opacity","transition","showLabel","labelEngine","labelgun","default","id","labels","totalMarkers","resetLabels","markers","reset","i","j","length","eachLayer","addLabel","update","layer","getTooltip","_source","_tooltip","_container","rect","getBoundingClientRect","bottomLeft","map","containerPointToLatLng","left","bottom","topRight","right","top","boundingBox","lng","lat","ingestLabel","parseInt","Math","random","added","addTo"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAIA,YAAY,SAAZA,SAAY,CAASC,KAAT,EAAgB;AAC5BA,QAAMC,WAAN,CAAkBC,KAAlB,CAAwBC,OAAxB,GAAkC,CAAlC;AACAH,QAAMC,WAAN,CAAkBC,KAAlB,CAAwBE,UAAxB,GAAqC,YAArC;AACH,CAHD;AAIA,IAAIC,YAAY,SAAZA,SAAY,CAASL,KAAT,EAAgB;AAC5BA,QAAMC,WAAN,CAAkBC,KAAlB,CAAwBC,OAAxB,GAAkC,CAAlC;AACAH,QAAMC,WAAN,CAAkBC,KAAlB,CAAwBE,UAAxB,GAAqC,YAArC;AACH,CAHD;AAIAE,cAAc,IAAIC,SAASC,OAAb,CAAqBT,SAArB,EAAgCM,SAAhC,CAAd;;AAEA,IAAII,KAAK,CAAT;AACA,IAAIC,SAAS,EAAb;AACA,IAAIC,eAAe,CAAnB;;AAEA,SAASC,WAAT,CAAqBC,OAArB,EAA8B;AAC1BP,cAAYQ,KAAZ;AACA,MAAIC,IAAI,CAAR;AACA,OAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIH,QAAQI,MAA5B,EAAoCD,GAApC,EAAyC;AACrCH,YAAQG,CAAR,EAAWE,SAAX,CAAqB,UAASlB,KAAT,EAAe;AAChCmB,eAASnB,KAAT,EAAgB,EAAEe,CAAlB;AACH,KAFD;AAGH;AACHT,cAAYc,MAAZ;AACD;;AAED,SAASD,QAAT,CAAkBE,KAAlB,EAAyBZ,EAAzB,EAA6B;;AAE3B;AACA,MAAIT,QAAQqB,MAAMC,UAAN,GAAmBC,OAAnB,CAA2BC,QAA3B,CAAoCC,UAAhD;AACA,MAAIzB,KAAJ,EAAW;;AAET;AACA,QAAI0B,OAAO1B,MAAM2B,qBAAN,EAAX;;AAEA;AACA,QAAIC,aAAaC,IAAIC,sBAAJ,CAA2B,CAACJ,KAAKK,IAAN,EAAYL,KAAKM,MAAjB,CAA3B,CAAjB;AACA,QAAIC,WAAWJ,IAAIC,sBAAJ,CAA2B,CAACJ,KAAKQ,KAAN,EAAaR,KAAKS,GAAlB,CAA3B,CAAf;AACA,QAAIC,cAAc;AAChBR,kBAAa,CAACA,WAAWS,GAAZ,EAAiBT,WAAWU,GAA5B,CADG;AAEhBL,gBAAa,CAACA,SAASI,GAAV,EAAeJ,SAASK,GAAxB;AAFG,KAAlB;;AAKA;AACAhC,gBAAYiC,WAAZ,CACEH,WADF,EAEE3B,EAFF,EAGE+B,SAASC,KAAKC,MAAL,MAAiB,IAAI,CAArB,IAA0B,CAAnC,CAHF,EAGyC;AACvC1C,SAJF,EAKE,UAAUS,EALZ,EAME,KANF;;AASA;AACA;AACA,QAAI,CAACY,MAAMsB,KAAX,EAAkB;AAChBtB,YAAMuB,KAAN,CAAYf,GAAZ;AACAR,YAAMsB,KAAN,GAAc,IAAd;AACD;AACF;AACF","file":"labels.15c84194.map","sourceRoot":"..","sourcesContent":["var hideLabel = function(label) {\n    label.labelObject.style.opacity = 0;\n    label.labelObject.style.transition = 'opacity 0s';\n};\nvar showLabel = function(label) {\n    label.labelObject.style.opacity = 1;\n    label.labelObject.style.transition = 'opacity 1s';\n};\nlabelEngine = new labelgun.default(hideLabel, showLabel);\n\nvar id = 0;\nvar labels = [];\nvar totalMarkers = 0;\n\nfunction resetLabels(markers) {\n    labelEngine.reset();\n    var i = 0;\n    for (var j = 0; j < markers.length; j++) {\n        markers[j].eachLayer(function(label){\n            addLabel(label, ++i);\n        });\n    }\n  labelEngine.update();\n}\n\nfunction addLabel(layer, id) {\n\n  // This is ugly but there is no getContainer method on the tooltip :(\n  var label = layer.getTooltip()._source._tooltip._container;\n  if (label) {\n\n    // We need the bounding rectangle of the label itself\n    var rect = label.getBoundingClientRect();\n\n    // We convert the container coordinates (screen space) to Lat/lng\n    var bottomLeft = map.containerPointToLatLng([rect.left, rect.bottom]);\n    var topRight = map.containerPointToLatLng([rect.right, rect.top]);\n    var boundingBox = {\n      bottomLeft : [bottomLeft.lng, bottomLeft.lat],\n      topRight   : [topRight.lng, topRight.lat]\n    };\n\n    // Ingest the label into labelgun itself\n    labelEngine.ingestLabel(\n      boundingBox,\n      id,\n      parseInt(Math.random() * (5 - 1) + 1), // Weight\n      label,\n      \"Test \" + id,\n      false\n    );\n\n    // If the label hasn't been added to the map already\n    // add it and set the added flag to true\n    if (!layer.added) {\n      layer.addTo(map);\n      layer.added = true;\n    }\n  }\n}"]}