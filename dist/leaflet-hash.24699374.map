{"version":3,"sources":["js/leaflet-hash.js"],"names":["window","HAS_HASHCHANGE","doc_mode","documentMode","undefined","L","Hash","map","onHashChange","Util","bind","init","parseHash","hash","indexOf","substr","args","split","length","zoom","parseInt","lat","parseFloat","lon","isNaN","center","LatLng","formatHash","getCenter","getZoom","precision","Math","max","ceil","log","LN2","toFixed","lng","join","prototype","lastHash","isListening","startListening","removeFrom","changeTimeout","clearTimeout","stopListening","onMapMove","movingMap","_loaded","location","replace","update","parsed","setView","changeDefer","that","setTimeout","hashChangeInterval","on","DomEvent","addListener","clearInterval","setInterval","off","removeListener","Map","addHash","_hash","removeHash"],"mappings":"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","file":"leaflet-hash.24699374.map","sourceRoot":"..","sourcesContent":["(function(window) {\n\tvar HAS_HASHCHANGE = (function() {\n\t\tvar doc_mode = window.documentMode;\n\t\treturn ('onhashchange' in window) &&\n\t\t\t(doc_mode === undefined || doc_mode > 7);\n\t})();\n\n\tL.Hash = function(map) {\n\t\tthis.onHashChange = L.Util.bind(this.onHashChange, this);\n\n\t\tif (map) {\n\t\t\tthis.init(map);\n\t\t}\n\t};\n\n\tL.Hash.parseHash = function(hash) {\n\t\tif(hash.indexOf('#') === 0) {\n\t\t\thash = hash.substr(1);\n\t\t}\n\t\tvar args = hash.split(\"/\");\n\t\tif (args.length == 3) {\n\t\t\tvar zoom = parseInt(args[0], 10),\n\t\t\tlat = parseFloat(args[1]),\n\t\t\tlon = parseFloat(args[2]);\n\t\t\tif (isNaN(zoom) || isNaN(lat) || isNaN(lon)) {\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\tcenter: new L.LatLng(lat, lon),\n\t\t\t\t\tzoom: zoom\n\t\t\t\t};\n\t\t\t}\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tL.Hash.formatHash = function(map) {\n\t\tvar center = map.getCenter(),\n\t\t    zoom = map.getZoom(),\n\t\t    precision = Math.max(0, Math.ceil(Math.log(zoom) / Math.LN2));\n\n\t\treturn \"#\" + [zoom,\n\t\t\tcenter.lat.toFixed(precision),\n\t\t\tcenter.lng.toFixed(precision)\n\t\t].join(\"/\");\n\t},\n\n\tL.Hash.prototype = {\n\t\tmap: null,\n\t\tlastHash: null,\n\n\t\tparseHash: L.Hash.parseHash,\n\t\tformatHash: L.Hash.formatHash,\n\n\t\tinit: function(map) {\n\t\t\tthis.map = map;\n\n\t\t\t// reset the hash\n\t\t\tthis.lastHash = null;\n\t\t\tthis.onHashChange();\n\n\t\t\tif (!this.isListening) {\n\t\t\t\tthis.startListening();\n\t\t\t}\n\t\t},\n\n\t\tremoveFrom: function(map) {\n\t\t\tif (this.changeTimeout) {\n\t\t\t\tclearTimeout(this.changeTimeout);\n\t\t\t}\n\n\t\t\tif (this.isListening) {\n\t\t\t\tthis.stopListening();\n\t\t\t}\n\n\t\t\tthis.map = null;\n\t\t},\n\n\t\tonMapMove: function() {\n\t\t\t// bail if we're moving the map (updating from a hash),\n\t\t\t// or if the map is not yet loaded\n\n\t\t\tif (this.movingMap || !this.map._loaded) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar hash = this.formatHash(this.map);\n\t\t\tif (this.lastHash != hash) {\n\t\t\t\tlocation.replace(hash);\n\t\t\t\tthis.lastHash = hash;\n\t\t\t}\n\t\t},\n\n\t\tmovingMap: false,\n\t\tupdate: function() {\n\t\t\tvar hash = location.hash;\n\t\t\tif (hash === this.lastHash) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar parsed = this.parseHash(hash);\n\t\t\tif (parsed) {\n\t\t\t\tthis.movingMap = true;\n\n\t\t\t\tthis.map.setView(parsed.center, parsed.zoom);\n\n\t\t\t\tthis.movingMap = false;\n\t\t\t} else {\n\t\t\t\tthis.onMapMove(this.map);\n\t\t\t}\n\t\t},\n\n\t\t// defer hash change updates every 100ms\n\t\tchangeDefer: 100,\n\t\tchangeTimeout: null,\n\t\tonHashChange: function() {\n\t\t\t// throttle calls to update() so that they only happen every\n\t\t\t// `changeDefer` ms\n\t\t\tif (!this.changeTimeout) {\n\t\t\t\tvar that = this;\n\t\t\t\tthis.changeTimeout = setTimeout(function() {\n\t\t\t\t\tthat.update();\n\t\t\t\t\tthat.changeTimeout = null;\n\t\t\t\t}, this.changeDefer);\n\t\t\t}\n\t\t},\n\n\t\tisListening: false,\n\t\thashChangeInterval: null,\n\t\tstartListening: function() {\n\t\t\tthis.map.on(\"moveend\", this.onMapMove, this);\n\n\t\t\tif (HAS_HASHCHANGE) {\n\t\t\t\tL.DomEvent.addListener(window, \"hashchange\", this.onHashChange);\n\t\t\t} else {\n\t\t\t\tclearInterval(this.hashChangeInterval);\n\t\t\t\tthis.hashChangeInterval = setInterval(this.onHashChange, 50);\n\t\t\t}\n\t\t\tthis.isListening = true;\n\t\t},\n\n\t\tstopListening: function() {\n\t\t\tthis.map.off(\"moveend\", this.onMapMove, this);\n\n\t\t\tif (HAS_HASHCHANGE) {\n\t\t\t\tL.DomEvent.removeListener(window, \"hashchange\", this.onHashChange);\n\t\t\t} else {\n\t\t\t\tclearInterval(this.hashChangeInterval);\n\t\t\t}\n\t\t\tthis.isListening = false;\n\t\t}\n\t};\n\tL.hash = function(map) {\n\t\treturn new L.Hash(map);\n\t};\n\tL.Map.prototype.addHash = function() {\n\t\tthis._hash = L.hash(this);\n\t};\n\tL.Map.prototype.removeHash = function() {\n\t\tthis._hash.removeFrom();\n\t};\n})(window);\n"]}